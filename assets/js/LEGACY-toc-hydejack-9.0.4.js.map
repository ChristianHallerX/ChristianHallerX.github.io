{"version":3,"sources":["webpack:///./_js/src/pro/toc.js"],"names":["stylesheetReady","isLarge$","fromMediaQuery","window","matchMedia","BREAK_POINT_DYNAMIC","pipe","startWith","map","m","matches","pushState","document","getElementById","drawerEl","_noDrawer","initialized","load$","_noPushState","fromEvent","of","toc$","querySelector","share","combineLatest","switchMap","toc","isLarge","NEVER","scrollspy","createElement","style","position","top","parentNode","insertBefore","createIntersectionObservable","mergeAll","x","isIntersecting","boundingClientRect","tap","affix","classList","add","remove","finalize","subscribe","intersecting","Set","WeakMap","toObserve","Array","from","querySelectorAll","el","children","getAttribute","hash","substr","filter","init","entries","forEach","target","set","getScrollTop","delete","curr","reduce","min","get","fontWeight","id"],"mappings":"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","file":"LEGACY-toc-hydejack-9.0.4.js","sourcesContent":["// Copyright (c) 2020 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { fromEvent, NEVER, combineLatest, of } from 'rxjs';\nimport { map, tap, switchMap, startWith, share, finalize, mergeAll } from 'rxjs/operators';\n\nimport {\n  BREAK_POINT_DYNAMIC,\n  getScrollTop,\n  createIntersectionObservable,\n  stylesheetReady,\n  fromMediaQuery,\n} from '../common';\n\n(async () => {\n  await stylesheetReady;\n\n  const isLarge$ = fromMediaQuery(window.matchMedia(BREAK_POINT_DYNAMIC)).pipe(\n    startWith(window.matchMedia(BREAK_POINT_DYNAMIC)),\n    map((m) => m.matches),\n  );\n\n  const pushState = document.getElementById('_pushState');\n  const drawerEl = document.getElementById('_drawer');\n  if (!pushState) return;\n\n  if (drawerEl && !window._noDrawer) await drawerEl.initialized;\n  await pushState.initialized;\n\n  const load$ = !window._noPushState ? fromEvent(pushState, 'load').pipe(startWith({})) : of({});\n\n  const toc$ = load$.pipe(\n    map(() => document.querySelector('#markdown-toc')),\n    share(),\n  );\n\n  combineLatest(toc$, isLarge$)\n    .pipe(\n      switchMap(([toc, isLarge]) => {\n        if (!toc || !isLarge) return NEVER;\n\n        const scrollspy = document.createElement('div');\n        scrollspy.style.position = 'relative';\n        scrollspy.style.top = '-1rem';\n        toc.parentNode.insertBefore(scrollspy, toc);\n\n        return createIntersectionObservable(scrollspy).pipe(\n          mergeAll(),\n          map((x) => !x.isIntersecting && x.boundingClientRect.top < 0),\n          tap((affix) => {\n            if (affix) {\n              toc.classList.add('affix');\n            } else {\n              toc.classList.remove('affix');\n            }\n          }),\n          finalize(() => {\n            toc.classList.remove('affix');\n          }),\n        );\n      }),\n    )\n    .subscribe();\n\n  combineLatest(toc$, isLarge$)\n    .pipe(\n      switchMap(([toc, isLarge]) => {\n        if (!toc || !isLarge) return NEVER;\n\n        const intersecting = new Set();\n        const top = new WeakMap();\n\n        const toObserve = Array.from(toc.querySelectorAll('li'))\n          .map((el) => el.children[0].getAttribute('href') || '')\n          .map((hash) => document.getElementById(hash.substr(1)))\n          .filter((el) => !!el);\n\n        let init = true;\n        return createIntersectionObservable(toObserve).pipe(\n          tap((entries) => {\n            if (init) {\n              entries.forEach(({ target, boundingClientRect }) =>\n                top.set(target, getScrollTop() + boundingClientRect.top),\n              );\n              init = false;\n            }\n\n            entries.forEach(({ isIntersecting, target }) => {\n              isIntersecting ? intersecting.add(target) : intersecting.delete(target);\n            });\n\n            const curr = Array.from(intersecting).reduce((min, el) => (top.get(el) >= top.get(min) ? min : el), null);\n            if (curr) {\n              toc.querySelectorAll('a').forEach((el) => {\n                el.style.fontWeight = '';\n              });\n              const el = toc.querySelector(`a[href=\"#${curr.id}\"]`);\n              if (el) el.style.fontWeight = 'bold';\n            }\n          }),\n          finalize(() => {\n            toc.querySelectorAll('a').forEach((el) => {\n              el.style.fontWeight = '';\n            });\n          }),\n        );\n      }),\n    )\n    .subscribe();\n})();\n"],"sourceRoot":""}